function model_stage = do_mask_train(conf, dataset, model_stage, do_val, db)
    if ~do_val
        dataset.imdb_test = struct();
        dataset.roidb_test = struct();
    end
    if strcmp(db, 'voc')
       model_stage.output_model_file = mask_train_voc(conf, dataset.imdb_train, dataset.roidb_train, ...
                                    'do_val',           do_val, ...
                                    'imdb_val',         dataset.imdb_test, ...
                                    'roidb_val',        dataset.roidb_test, ...
                                    'solver_def_file',  model_stage.solver_def_file, ...
                                    'net_file',         model_stage.init_net_file, ...
                                    'cache_name',       model_stage.cache_name);
      
    else
      model_stage.output_model_file = mask_train_coco(conf, dataset.imdb_train, dataset.roidb_train, ...
                                    'do_val',           do_val, ...
                                    'imdb_val',         dataset.imdb_test, ...
                                    'roidb_val',        dataset.roidb_test, ...
                                    'solver_def_file',  model_stage.solver_def_file, ...
                                    'net_file',         model_stage.init_net_file, ...
                                    'cache_name',       model_stage.cache_name);
    end
end
